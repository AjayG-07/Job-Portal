{% extends 'jobs/base.html' %}
{%load static%}
{% block content %}
<div class="container mt-4">
    <h2 class="mb-4">Job Seeker Dashboard</h2>

  <!-- Profile Overview -->
<div class="card p-4 mb-4">
    <h4>Profile Overview</h4>
    <div class="row">
        <div class="col-md-3 text-center">
            {% if profile.image %}
                <img src="{{ profile.image.url }}" class="img-fluid rounded-circle" alt="Profile Picture" style="width: 150px; height: 150px; object-fit: cover;">
            {% else %}
                <img src="{% static 'images/p2.jpeg' %}" class="img-fluid rounded-circle" alt="Default Profile" style="width: 150px; height: 150px; object-fit: cover;">
            {% endif %}
        </div>
        <div class="col-md-9">
            <p><strong>Name:</strong> {{ request.user.username }}</p>
            <p><strong>Email:</strong> {{ request.user.email }}</p>
            {% if profile.phone %}
                <p><strong>Phone:</strong> {{ profile.phone }}</p>
            {% endif %}
            <p><strong>Skills:</strong> {{ profile.skills }}</p>
           <a href="{% url 'profile_update' %}" class="btn btn-primary">Edit Profile</a>


        </div>
    </div>
</div>


    <!-- Job Applications -->
    <div class="card p-4 mb-4">
        <h4>Job Applications</h4>
        <table class="table">
            <thead>
                <tr>
                    <th>Job Title</th>
                    <th>Company</th>
                    <th>Status</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for app in applied_jobs %}
                <tr>
                    <td>{{ app.job.title }}</td>
                    <td>{{ app.job.company_name }}</td>
                    <td><span class="badge bg-info">{{ app.status }}</span></td>
                    <td>
                        <a href="{% url 'withdraw_application' app.job.id %}" class="btn btn-danger btn-sm">Withdraw</a>
                    </td>
                    
                </tr>
                {% empty %}
                <tr><td colspan="4" class="text-center">No applications found.</td></tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <!-- Saved Jobs -->
    <div class="card p-4 mb-4">
        <h4>Saved Jobs</h4>
        <table class="table">
            <thead>
                <tr>
                    <th>Job Title</th>
                    <th>Company</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for saved in saved_jobs %}
                <tr>
                    <td>{{ saved.job.title }}</td>
                    <td>{{ saved.job.company_name }}</td>
                    <td>
                       
                            {% if saved.job.id %}
                                <a href="{% url 'apply_job' saved.job.id %}" class="btn btn-primary btn-sm">Apply Now</a>
                            {% else %}
                                <span class="text-danger">Job Not Available</span>
                            {% endif %}
                            <a href="{% url 'remove_saved_job' saved.job.id %}" class="btn btn-warning btn-sm">Remove</a>

                    </td>
                </tr>
                {% empty %}
                <tr><td colspan="3" class="text-center">No saved jobs.</td></tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <!-- Resume Upload -->
    <div class="card p-4 mb-4">
        <h4>Resume Upload</h4>

        {% if profile.resume %}
            <p><strong>Uploaded Resume:</strong> <a href="{{ profile.resume.url }}" target="_blank">View Resume</a></p>
        {% else %}
            <p>No resume uploaded yet.</p>
        {% endif %}

        <form method="POST" enctype="multipart/form-data">
            {% csrf_token %}
            {{ resume_form.as_p }}
            <button type="submit" name="resume_submit" class="btn btn-primary">Upload Resume</button>
        </form>
    </div>

    <!-- Job Preferences -->
    <div class="card p-4 mb-4">
        <h4>Job Preferences</h4>

        <form method="POST">
            {% csrf_token %}
            {{ preferences_form.as_p }}
            <button type="submit" name="preferences_submit" class="btn btn-success">Save Preferences</button>
        </form>
    </div>

    <!-- Recommended Jobs -->
    <div class="card p-4 mb-4">
        <h4>Recommended Jobs</h4>
        {% if recommended_jobs %}
            <ul class="list-group">
                {% for rec in recommended_jobs %}
                    <li class="list-group-item">
                        <h5>{{ rec.job.title }}</h5>
                        <p><strong>{{ rec.job.company_name }}</strong> - {{ rec.job.location }}</p>
                        <p>Score: {{ rec.score|floatformat:2 }}</p>
                        <a href="{% url 'job_detail' rec.job.id %}" class="btn btn-primary btn-sm">View Job</a>
                        <a href="{% url 'save_job' rec.job.id %}" class="btn btn-warning btn-sm">Save Job</a>
                    </li>
                {% endfor %}
            </ul>
        {% else %}
            <p>No recommendations available yet.</p>
        {% endif %}
    </div>
</div>
{% endblock %}




































<!-- <div class="container mt-4">
    <h2 class="mb-4">Job Seeker Dashboard</h2> -->

    <!-- Profile Overview -->
    <!-- <div class="card p-4 mb-4">
        <h4>Profile Overview</h4>
        <div class="row">
            <div class="col-md-3">
                <img src="https://via.placeholder.com/100" class="img-fluid rounded-circle" alt="Profile Picture">
            </div>
            <div class="col-md-9">
                <p><strong>Name:</strong> {{ request.user.get_full_name }}</p>
                <p><strong>Email:</strong> {{ request.user.email }}</p>
                <p><strong>Phone:</strong> {{ request.user.profile.phone }}</p>
                <p><strong>Skills:</strong> {{ request.user.profile.skills }}</p>
                <a href="#" class="btn btn-primary">Edit Profile</a>
            </div>
        </div>
    </div> -->

    <!-- Job Applications -->
    <!-- <div class="card p-4 mb-4">
        <h4>Job Applications</h4>
        <table class="table">
            <thead>
                <tr>
                    <th>Job Title</th>
                    <th>Company</th>
                    <th>Status</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for app in applied_jobs %}
                <tr>
                    <td>{{ app.job.title }}</td>
                    <td>{{ app.job.company_name }}</td>
                    <td><span class="badge bg-info">{{ app.status }}</span></td>
                    <td>
                        <a href="#" class="btn btn-danger btn-sm">Withdraw</a>
                    </td>
                </tr>
                {% empty %}
                <tr><td colspan="4" class="text-center">No applications found.</td></tr>
                {% endfor %}
            </tbody>
        </table>
    </div> -->

    <!-- Saved Jobs -->
    <!-- <div class="card p-4 mb-4">
        <h4>Saved Jobs</h4>
        <table class="table">
            <thead>
                <tr>
                    <th>Job Title</th>
                    <th>Company</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for saved in saved_jobs %}
                <tr>
                    <td>{{ saved.job.title }}</td>
                    <td>{{ saved.job.company_name }}</td>
                    <td>
                        <a href="#" class="btn btn-success btn-sm">Quick Apply</a>
                        <a href="#" class="btn btn-warning btn-sm">Remove</a>
                    </td>
                </tr>
                {% empty %}
                <tr><td colspan="3" class="text-center">No saved jobs.</td></tr>
                {% endfor %}
            </tbody>
        </table>
    </div> -->

    <!-- Resume Upload -->
    <!-- <div class="card p-4 mb-4">
        <h4>Resume Upload</h4>

        {% if profile.resume %}
            <p><strong>Uploaded Resume:</strong> <a href="{{ profile.resume.url }}" target="_blank">View Resume</a></p>
        {% else %}
            <p>No resume uploaded yet.</p>
        {% endif %}

        <form method="POST" enctype="multipart/form-data">
            {% csrf_token %}
            {{ resume_form.as_p }}
            <button type="submit" name="resume_submit" class="btn btn-primary">Upload Resume</button>
        </form>
    </div> -->

    <!-- Job Preferences -->
    <!-- <div class="card p-4 mb-4">
        <h4>Job Preferences</h4>

        <form method="POST">
            {% csrf_token %}
            {{ preferences_form.as_p }}
            <button type="submit" name="preferences_submit" class="btn btn-success">Save Preferences</button>
        </form>
    </div> -->

    <!-- Recommended Jobs -->
    <!-- <div class="card p-4 mb-4">
        <h4>Recommended Jobs</h4>
        {% if recommended_jobs %}
            <ul class="list-group">
                {% for rec in recommended_jobs %}
                    <li class="list-group-item">
                        <h5>{{ rec.job.title }}</h5>
                        <p><strong>{{ rec.job.company.name }}</strong> - {{ rec.job.location }}</p>
                        <p>Score: {{ rec.score|floatformat:2 }}</p>
                        <a href="{% url 'job_detail' rec.job.id %}" class="btn btn-primary btn-sm">View Job</a>
                        {% if job %}
                        <li class="nav-item"><a class="nav-link" href="{% url 'save_job' job.id %}">Saved Jobs</a></li>
                        {% endif %}

                    </li>
                {% endfor %}
            </ul>
        {% else %}
            <p>No recommendations available yet.</p>
        {% endif %}
    </div>
</div> -->

